<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dexscreener Bot Setup</title>
    <style>
        body {
            background-color: #121212;
            color: #e0e0e0;
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
        }

        .filters-container {
            font-family: Arial, sans-serif;
            padding: 15px;
            border: 1px solid #555;
            border-radius: 8px;
            max-width: 350px;
            background: #333;
            margin-top: 20px;
        }

        .filter-group {
            margin: 15px 0;
        }

        .filter-label {
            font-weight: bold;
            display: block;
            margin-bottom: 5px;
        }

        .input-row {
            display: flex;
            gap: 10px;
        }

        .input-wrapper {
            display: flex;
            align-items: center;
            border: 1px solid #555;
            padding: 5px;
            border-radius: 5px;
            width: 100%;
            background: #444;
        }

        .input-prefix, .input-suffix {
            padding: 0 5px;
            font-weight: bold;
        }

        input {
            border: none;
            outline: none;
            flex-grow: 1;
            background: transparent;
            text-align: left;
            color: #e0e0e0;
        }

        select {
            border: 1px solid #555;
            padding: 5px;
            border-radius: 5px;
            background: #444;
            color: #e0e0e0;
            width: 100%;
        }

        button {
            cursor: pointer;
        }

        #filterPopup {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #222;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.7);
            z-index: 1000;
            width: 400px;
        }

        #filterPopup h2 {
            margin: 0 0 15px;
            text-align: center;
            color: #64b5f6;
        }

        .error {
            border: 2px solid #ff5722;
        }

        /* Modal overlay to darken the background when popup is open */
        #modalOverlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 900;
        }
        
        /* Social icons container */
        .social-container {
            position: fixed;
            bottom: 10px;
            width: 100%;
            text-align: center;
        }
        .social-container a {
            margin: 0 10px;
            color: #e0e0e0;
            text-decoration: none;
        }
        .social-container a svg {
            vertical-align: middle;
            width: 32px;
            height: 32px;
            transition: transform 0.3s;
        }
        .social-container a:hover svg {
            transform: scale(1.1);
        }
    </style>
</head>
<body>
    <h1>Welcome, Amazing User! üòä</h1>
    <p>
        We‚Äôre thrilled to have you here! üöÄ Set up your custom filters below to start scraping Dexscreener‚Äôs trending tokens. 
        Follow the simple steps, and if you have any questions, join our community via our social channels below!
    </p>
    <ol>
        <li>Add a bot to your group ü§ñ</li>
        <li>Obtain your channel ID üì®</li>
        <li>
            Get the WebSocket URL for Dexscreener filters. Use this format:
            <pre style="background-color: #333; padding: 10px;">wss://io.dexscreener.com/dex/screener/v4/pairs/h24/1?rankBy[key]=trendingScoreH6&amp;rankBy[order]=desc</pre>
        </li>
        <li>Add custom filters on the main URL by clicking "ADD FILTER" üîß</li>
        <li>Schedule a cron job to ping Dex at your desired time ‚è∞</li>
        <li><span style="font-weight: bold; color: #ff5722;">NOTE:</span> This code is working perfectly! üëç</li>
    </ol>

    <button id="addFilterButton" style="background-color: #1e88e5; color: white; padding: 10px 15px; border: none; border-radius: 5px; cursor: pointer; margin-top: 20px;">ADD FILTER</button>

    <!-- Modal overlay -->
    <div id="modalOverlay"></div>

    <div id="filterPopup">
        <h2>DEX FILTERS</h2>

        <div class="filter-group">
            <span class="filter-label">Chain:</span>
            <select id="chainSelect">
                <option value="">Select a chain</option>
                <option value="solana">Solana</option>
                <option value="base">Base</option>
                <option value="ethereum">Ethereum</option>
                <option value="bsc">BSC</option>
                <option value="avalanche">Avalanche</option>
                <option value="pulsechain">PulseChain</option>
                <option value="sonic">Sonic</option>
                <option value="ton">TON</option>
                <option value="custom">Custom Chain</option>
            </select>
        </div>

        <div class="filter-group" id="customChainGroup" style="display: none;">
            <span class="filter-label">Enter Your Desired Chain:</span>
            <input type="text" id="customChain" placeholder="Enter your desired chain">
        </div>

        <div class="filter-group">
            <span class="filter-label">Liquidity:</span>
            <div class="input-row">
                <div class="input-wrapper">
                    <span class="input-prefix">$</span>
                    <input type="text" placeholder="Min" inputmode="numeric" id="liquidityMin" oninput="formatNumber(this)">
                </div>
                <div class="input-wrapper">
                    <span class="input-prefix">$</span>
                    <input type="text" placeholder="Max" inputmode="numeric" id="liquidityMax" oninput="formatNumber(this)">
                </div>
            </div>
        </div>

        <div class="filter-group">
            <span class="filter-label">Market Cap:</span>
            <div class="input-row">
                <div class="input-wrapper">
                    <span class="input-prefix">$</span>
                    <input type="text" placeholder="Min" inputmode="numeric" id="marketCapMin" oninput="formatNumber(this)">
                </div>
                <div class="input-wrapper">
                    <span class="input-prefix">$</span>
                    <input type="text" placeholder="Max" inputmode="numeric" id="marketCapMax" oninput="formatNumber(this)">
                </div>
            </div>
        </div>

        <div class="filter-group">
            <span class="filter-label">FDV:</span>
            <div class="input-row">
                <div class="input-wrapper">
                    <span class="input-prefix">$</span>
                    <input type="text" placeholder="Min" inputmode="numeric" id="fdvMin" oninput="formatNumber(this)">
                </div>
                <div class="input-wrapper">
                    <span class="input-prefix">$</span>
                    <input type="text" placeholder="Max" inputmode="numeric" id="fdvMax" oninput="formatNumber(this)">
                </div>
            </div>
        </div>

        <div class="filter-group">
            <span class="filter-label">Pair Age (Hours):</span>
            <div class="input-row">
                <input type="text" placeholder="Min" inputmode="numeric" id="pairAgeMin" oninput="formatNumber(this)">
                <input type="text" placeholder="Max" inputmode="numeric" id="pairAgeMax" oninput="formatNumber(this)">
            </div>
        </div>

        <div class="filter-group">
            <span class="filter-label">24H Transactions:</span>
            <div class="input-row">
                <input type="text" placeholder="Min" inputmode="numeric" id="txns24Min" oninput="formatNumber(this)">
                <input type="text" placeholder="Max" inputmode="numeric" id="txns24Max" oninput="formatNumber(this)">
            </div>
        </div>

        <button id="submitFilters" style="background-color: #4caf50; color: white; padding: 10px 15px; border: none; border-radius: 5px; cursor: pointer; margin-top: 20px; width: 100%;">SUBMIT</button>
    </div>

    <div id="filterResult" style="margin-top: 20px;"></div>

    <script>
        function formatNumber(input) {
            // Remove non-numeric characters except for commas
            let value = input.value.replace(/[^0-9]/g, '');
            // Format the number with commas
            input.value = value.replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }

        // Open popup when "ADD FILTER" button is clicked
        document.getElementById('addFilterButton').addEventListener('click', function() {
            document.getElementById('filterPopup').style.display = 'block';
            document.getElementById('modalOverlay').style.display = 'block';
        });

        // Show or hide the custom chain input based on selection
        document.getElementById('chainSelect').addEventListener('change', function() {
            const customChainGroup = document.getElementById('customChainGroup');
            customChainGroup.style.display = this.value === 'custom' ? 'block' : 'none';
        });

        // Close popup when clicking outside of it (on the modal overlay)
        document.getElementById('modalOverlay').addEventListener('click', function() {
            document.getElementById('filterPopup').style.display = 'none';
            document.getElementById('modalOverlay').style.display = 'none';
        });

        // Handle form submission and redirect to /dex with the filter string as a query parameter
        document.getElementById('submitFilters').addEventListener('click', function() {
            let chain = document.getElementById('chainSelect').value;
            if (chain === 'custom') {
                chain = document.getElementById('customChain').value;
            }

            let liquidityMin = document.getElementById('liquidityMin');
            let liquidityMax = document.getElementById('liquidityMax');
            let marketCapMin = document.getElementById('marketCapMin');
            let marketCapMax = document.getElementById('marketCapMax');
            let fdvMin = document.getElementById('fdvMin');
            let fdvMax = document.getElementById('fdvMax');
            let pairAgeMin = document.getElementById('pairAgeMin');
            let pairAgeMax = document.getElementById('pairAgeMax');
            let txns24Min = document.getElementById('txns24Min');
            let txns24Max = document.getElementById('txns24Max');

            let isValid = true;

            // Validate numeric inputs
            [liquidityMin, liquidityMax, marketCapMin, marketCapMax, fdvMin, fdvMax, pairAgeMin, pairAgeMax, txns24Min, txns24Max].forEach(input => {
                if (input.value && isNaN(input.value.replace(/,/g, ''))) {
                    input.classList.add('error');
                    isValid = false;
                } else {
                    input.classList.remove('error');
                }
            });

            if (!isValid) {
                return; // Don't proceed if invalid
            }

            let filterString = "wss://io.dexscreener.com/dex/screener/v5/pairs/h24/1?rankBy[key]=trendingScoreH6&rankBy[order]=desc";

            // Add only set values for each filter
            if (liquidityMin.value) {
                filterString += `&filters[liquidity][min]=${liquidityMin.value.replace(/,/g, '')}`;
            }
            if (liquidityMax.value) {
                filterString += `&filters[liquidity][max]=${liquidityMax.value.replace(/,/g, '')}`;
            }
            if (marketCapMin.value) {
                filterString += `&filters[marketCap][min]=${marketCapMin.value.replace(/,/g, '')}`;
            }
            if (marketCapMax.value) {
                filterString += `&filters[marketCap][max]=${marketCapMax.value.replace(/,/g, '')}`;
            }
            if (fdvMin.value) {
                filterString += `&filters[fdv][min]=${fdvMin.value.replace(/,/g, '')}`;
            }
            if (fdvMax.value) {
                filterString += `&filters[fdv][max]=${fdvMax.value.replace(/,/g, '')}`;
            }
            if (pairAgeMin.value) {
                filterString += `&filters[pairAge][min]=${pairAgeMin.value.replace(/,/g, '')}`;
            }
            if (pairAgeMax.value) {
                filterString += `&filters[pairAge][max]=${pairAgeMax.value.replace(/,/g, '')}`;
            }
            if (txns24Min.value) {
                filterString += `&filters[txns][h24][min]=${txns24Min.value.replace(/,/g, '')}`;
            }
            if (txns24Max.value) {
                filterString += `&filters[txns][h24][max]=${txns24Max.value.replace(/,/g, '')}`;
            }
            if (chain) {
                filterString += `&filters[chainIds][0]=${chain}`;
            }

            // Redirect to /dex with the filter string as a query parameter
            window.location.href = "/dex?generated_text=" + encodeURIComponent(filterString);
        });
    </script>
    
    <!-- Social icons bottom center -->
    <div class="social-container">
        <a href="https://t.me/doffn" target="_blank" title="Telegram">
            <!-- Telegram Icon SVG -->
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 240 240" fill="#0088cc">
                <circle cx="120" cy="120" r="120" fill="#0088cc"/>
                <path d="M100.3 158.1l-.4 15.7c.6 0 .9-.3 1.3-.7l26.2-25.2 54.3 39.8c10 5.6 17.2 2.8 19.8-8.1l36.1-168.8c2.9-13.3-4.8-18.7-13.7-15.4L21.8 106.7c-11.5 4.3-11.4 10.8 2.3 13.6l56.2 17.5 130.7-81.8c6.1-3.8 11.7-1.8 8.9 3.6L100.3 158.1z"/>
            </svg>
        </a>
        <a href="https://twitter.com/doffneri" target="_blank" title="Twitter">
            <!-- Twitter Icon SVG -->
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#1DA1F2">
                <path d="M24 4.557a9.95 9.95 0 0 1-2.828.775A4.932 4.932 0 0 0 23.337 3a9.864 9.864 0 0 1-3.127 1.195 4.92 4.92 0 0 0-8.38 4.482A13.957 13.957 0 0 1 1.671 3.149a4.922 4.922 0 0 0 1.523 6.574A4.904 4.904 0 0 1 .96 9.064v.062a4.92 4.92 0 0 0 3.946 4.827 4.902 4.902 0 0 1-2.224.084 4.922 4.922 0 0 0 4.6 3.417A9.867 9.867 0 0 1 0 19.54a13.94 13.94 0 0 0 7.548 2.212c9.058 0 14.01-7.504 14.01-14.009 0-.213-.004-.425-.014-.636A10.012 10.012 0 0 0 24 4.557z"/>
            </svg>
        </a>
        <a href="mailto:dawitneri888@example.com" target="_blank" title="Gmail">
            <!-- Gmail Icon SVG -->
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#D44638">
                <path d="M12 13.065L0 6.3V18c0 1.104.896 2 2 2h20c1.104 0 2-.896 2-2V6.3l-12 6.765zM12 11l12-6H0l12 6z"/>
            </svg>
        </a>
    </div>
</body>
</html>
